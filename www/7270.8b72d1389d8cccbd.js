"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7270],{7270:(J,C,s)=>{s.r(C),s.d(C,{FeedbackDetailPageModule:()=>z});var _=s(177),h=s(9417),m=s(791),f=s(7625),d=s(467),F=s(2254),p=s(5972);const P=function(){var l=(0,d.A)(function*(i){var o,a,n;i.params=i.params||{},(0,p.Ll)({url:"api/FeedbackComment/create",params:{FeedbackId:null!==(o=i.params.FeedbackId)&&void 0!==o?o:null,PId:null!==(a=i.params.PId)&&void 0!==a?a:null,Comment:null!==(n=i.params.Comment)&&void 0!==n?n:null},success:t=>{"function"==typeof i.callback&&i.callback(t.data||null)},error:t=>{var c;"function"==typeof i.callback&&i.callback(null==t||null===(c=t.response)||void 0===c?void 0:c.data),console.error(t)},loading:i.loading,loadingController:i.loadingController})});return function(o){return l.apply(this,arguments)}}(),v=function(){var l=(0,d.A)(function*(i){var o,a,n;i.params=i.params||{},(0,p.IH)({url:"api/FeedbackComment/update",params:{FeedbackId:null!==(o=i.params.FeedbackId)&&void 0!==o?o:null,PId:null!==(a=i.params.PId)&&void 0!==a?a:null,Comment:null!==(n=i.params.Comment)&&void 0!==n?n:null},success:t=>{"function"==typeof i.callback&&i.callback(t.data||null)},error:t=>{var c;"function"==typeof i.callback&&i.callback(null==t||null===(c=t.response)||void 0===c?void 0:c.data),console.error(t)},loading:i.loading,loadingController:i.loadingController})});return function(o){return l.apply(this,arguments)}}(),I=function(){var l=(0,d.A)(function*(i){var o,a,n;i.params=i.params||{},(0,p.hm)({url:"api/FeedbackComment/get-feedbackcommentbyfbid",params:{FeedbackId:null!==(o=i.params.FeedbackId)&&void 0!==o?o:null,PageNumber:null!==(a=i.params.PageNumber)&&void 0!==a?a:1,PageSize:null!==(n=i.params.PageSize)&&void 0!==n?n:10},success:t=>{"function"==typeof i.callback&&i.callback(t.data||null)},error:t=>{var c;"function"==typeof i.callback&&i.callback(null==t||null===(c=t.response)||void 0===c?void 0:c.data),console.error(t)},loading:i.loading,loadingController:i.loadingController})});return function(o){return l.apply(this,arguments)}}(),$=function(){var l=(0,d.A)(function*(i){i.params=i.params||{},(0,p.sj)({url:`api/FeedbackComment/delete/${i.params.FbCommentId}`,params:{},success:o=>{"function"==typeof i.callback&&i.callback(o.data||null)},error:o=>{var a;"function"==typeof i.callback&&i.callback(null==o||null===(a=o.response)||void 0===a?void 0:a.data),console.error(o)},loading:i.loading,loadingController:i.loadingController})});return function(o){return l.apply(this,arguments)}}();var M=s(6539),D=s(8517),u=s(8650),R=s(8833),e=s(4438),O=s(4842);const b=l=>({$implicit:l});function y(l,i){if(1&l&&(e.j41(0,"small",19),e.EFF(1),e.k0s()),2&l){const o=e.XpG(2);e.R7$(),e.JRh(o.feedback.FbCatgTitle)}}function G(l,i){if(1&l&&(e.j41(0,"small"),e.EFF(1),e.k0s()),2&l){const o=e.XpG(2);e.R7$(),e.SpI("(",o.feedback.NumComment,")")}}function T(l,i){1&l&&(e.j41(0,"div",20),e.EFF(1),e.nI1(2,"translate"),e.k0s()),2&l&&(e.R7$(),e.JRh(e.bMT(2,1,"NoComment")))}function j(l,i){if(1&l&&e.eu8(0,23),2&l){const o=i.$implicit;e.XpG(3);const a=e.sdS(11);e.Y8G("ngTemplateOutlet",a)("ngTemplateOutletContext",e.eq3(2,b,o))}}function x(l,i){if(1&l&&(e.j41(0,"ion-list",21)(1,"ul"),e.DNE(2,j,1,4,"ng-container",22),e.k0s()()),2&l){const o=e.XpG(2);e.R7$(2),e.Y8G("ngForOf",o.filterComments())}}function N(l,i){if(1&l){const o=e.RV6();e.j41(0,"ion-infinite-scroll",24),e.bIt("ionInfinite",function(n){e.eBV(o);const t=e.XpG(2);return e.Njj(t.onIonInfinite(n))}),e.nrm(1,"ion-infinite-scroll-content"),e.k0s()}}function X(l,i){if(1&l){const o=e.RV6();e.qex(0),e.j41(1,"div",5)(2,"h6"),e.DNE(3,y,2,1,"small",6),e.k0s(),e.j41(4,"h4"),e.EFF(5),e.k0s(),e.nrm(6,"div",7),e.k0s(),e.j41(7,"div",8)(8,"div",9)(9,"div",10)(10,"h5"),e.EFF(11),e.nI1(12,"translate"),e.DNE(13,G,2,1,"small",4),e.k0s(),e.j41(14,"ion-item",11)(15,"ion-input",12),e.nI1(16,"translate"),e.bIt("ionChange",function(n){e.eBV(o);const t=e.XpG();return e.Njj(t.changeComment(n))})("keyup",function(n){e.eBV(o);const t=e.XpG();return e.Njj(t.keyupComment(n))}),e.k0s(),e.j41(17,"ion-button",13),e.bIt("click",function(n){e.eBV(o);const t=e.XpG();return e.Njj(t.sendComment(n,t.comment))}),e.nrm(18,"ion-icon",14),e.k0s()()()(),e.j41(19,"div",9)(20,"div",15),e.DNE(21,T,3,3,"div",16)(22,x,3,1,"ion-list",17),e.k0s()()(),e.DNE(23,N,2,0,"ion-infinite-scroll",18),e.bVm()}if(2&l){let o;const a=e.XpG();e.R7$(3),e.Y8G("ngIf",a.feedback.FbCatgId),e.R7$(2),e.JRh(a.feedback.Title),e.R7$(),e.Y8G("innerHTML",a.feedback.Content,e.npT),e.R7$(5),e.SpI("",e.bMT(12,10,"Comment")," "),e.R7$(2),e.Y8G("ngIf",a.feedback.NumComment),e.R7$(2),e.FS9("placeholder",e.bMT(16,12,"EnterComment")),e.Y8G("value",null!==(o=a.comment.Comment)&&void 0!==o?o:""),e.R7$(6),e.Y8G("ngIf",!(null!=a.comments&&a.comments.length)),e.R7$(),e.Y8G("ngIf",a.comments.length),e.R7$(),e.Y8G("ngIf",a.paging.active&&!a.paging.loading)}}function E(l,i){if(1&l){const o=e.RV6();e.qex(0),e.j41(1,"ion-item",27)(2,"ion-input",28),e.nI1(3,"translate"),e.bIt("ionChange",function(n){e.eBV(o);const t=e.XpG(2);return e.Njj(t.changeComment2(n))})("keyup",function(n){e.eBV(o);const t=e.XpG(2);return e.Njj(t.keyupComment2(n))}),e.k0s(),e.j41(4,"ion-button",29),e.bIt("click",function(n){e.eBV(o);const t=e.XpG(2);return e.Njj(t.sendComment(n,t.comment2))}),e.nrm(5,"ion-icon",14),e.k0s()(),e.bVm()}if(2&l){let o;const a=e.XpG(2);e.R7$(2),e.FS9("placeholder",e.bMT(3,3,"EnterComment")),e.Y8G("autofocus",!0)("value",null!==(o=a.comment2.Comment)&&void 0!==o?o:"")}}function S(l,i){if(1&l){const o=e.RV6();e.qex(0),e.j41(1,"ul")(2,"li")(3,"ion-item",27)(4,"ion-input",28),e.nI1(5,"translate"),e.bIt("ionChange",function(n){e.eBV(o);const t=e.XpG(3);return e.Njj(t.changeComment2(n))})("keyup",function(n){e.eBV(o);const t=e.XpG(3);return e.Njj(t.keyupComment2(n))}),e.k0s(),e.j41(6,"ion-button",29),e.bIt("click",function(n){e.eBV(o);const t=e.XpG(3);return e.Njj(t.sendComment(n,t.comment2))}),e.nrm(7,"ion-icon",14),e.k0s()()()(),e.bVm()}if(2&l){let o;const a=e.XpG(3);e.R7$(4),e.FS9("placeholder",e.bMT(5,3,"EnterReply")),e.Y8G("autofocus",!0)("value",null!==(o=a.comment2.Comment)&&void 0!==o?o:"")}}function A(l,i){if(1&l){const o=e.RV6();e.qex(0),e.j41(1,"ion-item-sliding")(2,"ion-item")(3,"ion-thumbnail",1),e.nrm(4,"img",30),e.k0s(),e.j41(5,"ion-label")(6,"div",31),e.EFF(7),e.j41(8,"small"),e.EFF(9),e.k0s()(),e.j41(10,"div",32),e.EFF(11),e.k0s(),e.j41(12,"div",33)(13,"small",34),e.bIt("click",function(n){e.eBV(o);const t=e.XpG().$implicit,c=e.XpG();return e.Njj(c.replyComment(n,t.FbCommentId))}),e.EFF(14),e.nI1(15,"translate"),e.k0s()()()(),e.j41(16,"ion-item-options",35)(17,"ion-item-option",36),e.nI1(18,"translate"),e.bIt("click",function(n){e.eBV(o);const t=e.XpG().$implicit,c=e.XpG();return e.Njj(c.editComment(n,t.FbCommentId))}),e.nrm(19,"ion-icon",37),e.k0s(),e.j41(20,"ion-item-option",38),e.nI1(21,"translate"),e.bIt("click",function(n){e.eBV(o);const t=e.XpG().$implicit,c=e.XpG();return e.Njj(c.deleteComment(n,t.FbCommentId))}),e.nrm(22,"ion-icon",39),e.k0s()()(),e.qex(23,25),e.DNE(24,S,8,5,"ng-container",26),e.bVm()()}if(2&l){let o;const a=e.XpG().$implicit,n=e.XpG();e.R7$(7),e.JRh(null!==(o=a.CustomerFullname)&&void 0!==o?o:"[T\xf4i]"),e.R7$(2),e.JRh(n.APP_FUNC_FormatDate(a.createddate)),e.R7$(2),e.JRh(a.Comment),e.R7$(3),e.JRh(e.bMT(15,8,"Reply")),e.R7$(3),e.Y8G("title",e.bMT(18,10,"Edit")),e.R7$(3),e.Y8G("title",e.bMT(21,12,"Delete")),e.R7$(3),e.Y8G("ngSwitch",n.comment2.PId==a.FbCommentId),e.R7$(),e.Y8G("ngSwitchCase",!0)}}function V(l,i){if(1&l&&e.eu8(0,23),2&l){const o=i.$implicit;e.XpG(2);const a=e.sdS(11);e.Y8G("ngTemplateOutlet",a)("ngTemplateOutletContext",e.eq3(2,b,o))}}function Y(l,i){if(1&l&&(e.j41(0,"li"),e.qex(1,25),e.DNE(2,E,6,5,"ng-container",26)(3,A,25,14,"ng-container",26),e.bVm(),e.j41(4,"ul"),e.DNE(5,V,1,4,"ng-container",22),e.k0s()()),2&l){const o=i.$implicit,a=e.XpG();e.R7$(),e.Y8G("ngSwitch",a.comment2.FbCommentId==o.FbCommentId),e.R7$(),e.Y8G("ngSwitchCase",!0),e.R7$(),e.Y8G("ngSwitchCase",!1),e.R7$(2),e.Y8G("ngForOf",a.filterComments(o.FbCommentId))}}const L=[{path:"",component:(()=>{var l;class i{constructor(a,n,t,c,r){var g;this.activatedRoute=a,this.loadingController=n,this.toastController=t,this.modalController=c,this.animationController=r,this.comment={},this.comment2={},this.comments=[],this.paging={sortfield:null,sorttype:null,page:1,limit:10,loading:!1,active:!0},this.filter={},this.APP_ROUTE=R._,this.APP_FUNC_FormatDate=D.Rv,this.limitLoad=0;let k=null!==(g=a.snapshot.params.id)&&void 0!==g?g:"";k&&(this.FeedbackId=parseFloat(k))}ngOnInit(){var a=this;(0,d.A)(function*(){(yield(0,M.kU)())&&a.refreshData()})()}onIonRefresher(a){this.refreshData(()=>{a.target.complete()})}onIonInfinite(a){this.loadMore(()=>{a.target.complete()})}pushData(a){1==this.paging.page&&(this.comments.length=0),this.comments=this.comments.concat(a)}refreshData(a){var n=this;return(0,d.A)(function*(){n.FeedbackId&&(n.filter={},n.paging.page=1,n.paging.active=!0,n.loadData_Paging_Limit(a),(0,F.C)({loadingController:n.loadingController,params:{FeedbackId:n.FeedbackId},callback:t=>{n.response=t,null!=t&&t.Succeeded?n.feedback=t.Data:(0,u.cX)(n.toastController,{},t).then(c=>c.present()),a&&a()}}))})()}loadMore(a){this.paging.page+=1,this.loadData_Paging_Limit(a)}searchChange(a){this.filter.search=a.target.value.replace(/\s+/g," ").trim(),this.paging.page=1,this.paging.active=!0,this.loadData_Paging_Limit()}sortChange(a,n){this.paging.sortfield=a||null,this.paging.sorttype=n||null,this.paging.page=1,this.paging.active=!0,this.loadData_Paging_Limit()}filterChange(){this.paging.page=1,this.paging.active=!0,this.loadData_Paging_Limit()}loadData_Paging_Limit(a){var n=this;return(0,d.A)(function*(){if(n.limitLoad>0)return void(a&&a());n.limitLoad=300;let t=setInterval(()=>{n.limitLoad-=100,n.limitLoad<=0&&(clearInterval(t),n.loadData_Paging(a))},100)})()}loadData_Paging(a){var n=this;return(0,d.A)(function*(){n.paging.loading=!0,I({loadingController:n.loadingController,params:{FeedbackId:n.FeedbackId,PageNumber:n.paging.page,PageSize:n.paging.limit},callback:t=>{var c;n.response=t,null!=t&&t.Succeeded?n.pushData(null!==(c=t.Data)&&void 0!==c?c:[]):(0,u.cX)(n.toastController,{},t).then(r=>r.present()),n.paging.loading=!1,n.paging.active=!(null==t||!t.HasNextPage),a&&a()}})})()}filterComments(a){return a?this.comments.filter(n=>n.PId==a).sort((n,t)=>{var c,r;return(null!==(c=t.FbCommentId)&&void 0!==c?c:0)-(null!==(r=n.FbCommentId)&&void 0!==r?r:0)}):this.comments.filter(n=>!n.PId).sort((n,t)=>{var c,r;return(null!==(c=t.FbCommentId)&&void 0!==c?c:0)-(null!==(r=n.FbCommentId)&&void 0!==r?r:0)})}keyupComment(a){var n=this;return(0,d.A)(function*(){13==a.keyCode&&n.sendComment(a,n.comment)})()}changeComment(a){var n=this;return(0,d.A)(function*(){var t;n.comment.Comment=null!==(t=a.detail.value)&&void 0!==t?t:""})()}keyupComment2(a){var n=this;return(0,d.A)(function*(){13==a.keyCode&&n.sendComment(a,n.comment2)})()}changeComment2(a){var n=this;return(0,d.A)(function*(){var t;n.comment2.Comment=null!==(t=a.detail.value)&&void 0!==t?t:""})()}replyComment(a,n){var t=this;return(0,d.A)(function*(){t.comment2={PId:n}})()}editComment(a,n){var t=this;return(0,d.A)(function*(){var c;t.comment2=null!==(c=t.comments.find(r=>r.FbCommentId==n))&&void 0!==c?c:{}})()}sendComment(a,n){var t=this;return(0,d.A)(function*(){n.Comment&&(n.FbCommentId?v({loadingController:t.loadingController,params:{FeedbackId:t.FeedbackId,FbCommentId:n.FbCommentId,PId:n.PId,Comment:n.Comment},callback:c=>{null!=c&&c.Succeeded?(t.comments.filter(r=>r.FbCommentId!=n.FbCommentId).forEach(r=>n),t.comment={},t.comment2={}):(0,u.cX)(t.toastController,{},c).then(r=>r.present())}}):P({loadingController:t.loadingController,params:{FeedbackId:t.FeedbackId,PId:n.PId,Comment:n.Comment},callback:c=>{null!=c&&c.Succeeded?(n.FbCommentId=c.Data,t.comments.push(n),t.comment={},t.comment2={}):(0,u.cX)(t.toastController,{},c).then(r=>r.present())}}))})()}deleteComment(a,n){var t=this;return(0,d.A)(function*(){n&&(0,u.Yy)(t.modalController,t.animationController,{selectedId:n,message:{TitleConfirm:"Delete_Confirm",TextConfirm:"Delete"},fnConfirm:c=>{$({loadingController:t.loadingController,params:{FbCommentId:c},callback:r=>{null!=r&&r.Succeeded?t.comments=t.comments.filter(g=>g.FbCommentId!=n&&g.PId!=n):(0,u.cX)(t.toastController,{},r).then(g=>{g.present()})}})}})})()}}return(l=i).\u0275fac=function(a){return new(a||l)(e.rXU(f.nX),e.rXU(m.Xi),e.rXU(m.K_),e.rXU(m.W3),e.rXU(m.Hx))},l.\u0275cmp=e.VBU({type:l,selectors:[["app-feedback-detail"]],decls:12,vars:3,consts:[["templateCommentLI",""],["slot","start"],["icon","../../../assets/icon/ion-icon/arrow-left.svg","text","",3,"defaultHref"],["slot","fixed",3,"ionRefresh"],[4,"ngIf"],[1,"container","py-4"],["class","text-muted",4,"ngIf"],[3,"innerHTML"],[1,"container","container-comment","mt-5","mb-5"],[1,"row","mb-4"],[1,"col-12","col-lg-8"],["lines","full","mode","ios"],[3,"ionChange","keyup","placeholder","value"],["slot","end","mode","ios","size","default","shape","clear",3,"click"],["name","paper-plane-outline"],[1,"col-12","col-lg-8","pl-0"],["class","p-3 text-muted small",4,"ngIf"],["lines","none",4,"ngIf"],[3,"ionInfinite",4,"ngIf"],[1,"text-muted"],[1,"p-3","text-muted","small"],["lines","none"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngFor","ngForOf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ionInfinite"],[3,"ngSwitch"],[4,"ngSwitchCase"],["lines","full"],[3,"ionChange","keyup","placeholder","autofocus","value"],["slot","end","mode","ios","size","large","shape","clear",3,"click"],["src","../../../assets/image/favicon.svg"],[1,"comment-name"],[1,"comment-content"],[1,"comment-action"],[3,"click"],["side","end"],["color","secondary",3,"click","title"],["name","create-outline"],["color","danger",3,"click","title"],["name","trash-outline"]],template:function(a,n){if(1&a){const t=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.j41(4,"ion-title"),e.EFF(5),e.k0s()()(),e.j41(6,"ion-content")(7,"ion-refresher",3),e.bIt("ionRefresh",function(r){return e.eBV(t),e.Njj(n.onIonRefresher(r))}),e.nrm(8,"ion-refresher-content"),e.k0s(),e.DNE(9,X,24,14,"ng-container",4),e.k0s(),e.DNE(10,Y,6,4,"ng-template",null,0,e.C5r)}if(2&a){let t;e.R7$(3),e.Y8G("defaultHref",n.APP_ROUTE.FEEDBACK),e.R7$(2),e.JRh(null!==(t=null==n.feedback?null:n.feedback.FbCatgTitle)&&void 0!==t?t:null==n.feedback?null:n.feedback.Title),e.R7$(4),e.Y8G("ngIf",n.feedback)}},dependencies:[_.Sq,_.bT,_.T3,_.ux,_.e1,m.Jm,m.QW,m.W9,m.eU,m.iq,m.Ax,m.Hp,m.$w,m.uz,m.LU,m.CE,m.A7,m.he,m.nf,m.To,m.Ki,m.Zx,m.BC,m.ai,m.Gw,m.el,O.D9],styles:[".container-comment[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:block;padding:0;margin:1rem 0}.container-comment[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]:empty{display:none}.container-comment[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:block;margin:0 0 .5rem}.container-comment[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:4rem}.container-comment[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{--ion-item-background: transparent}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-thumbnail[_ngcontent-%COMP%]{--size: 3rem;--border-radius: 50%;margin-top:0;margin-bottom:0;align-self:flex-start}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-top:0;margin-bottom:0}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-name[_ngcontent-%COMP%]{line-height:1.5rem;font-weight:500}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-name[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{margin-left:.5rem;font-size:.75rem;color:var(--ion-color-medium);vertical-align:top}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-content[_ngcontent-%COMP%]{line-height:1.5rem;white-space:wrap;text-align:justify}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-action[_ngcontent-%COMP%]{line-height:1.5rem}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]   .comment-action[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{line-height:1;vertical-align:middle;font-size:.75rem;color:var(--ion-color-primary);cursor:pointer}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;min-height:auto;margin:0;font-size:1rem;--background: var(--ion-color-secondary);--border-radius: .5rem;--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0}.container-comment[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.75rem}.container-comment[_ngcontent-%COMP%]   ion-item-option[_ngcontent-%COMP%]{text-transform:initial}.container-comment[_ngcontent-%COMP%]   ion-item-option[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}"]}),i})()}];let B=(()=>{var l;class i{}return(l=i).\u0275fac=function(a){return new(a||l)},l.\u0275mod=e.$C({type:l}),l.\u0275inj=e.G2t({imports:[f.iI.forChild(L),f.iI]}),i})();var U=s(3890);let z=(()=>{var l;class i{}return(l=i).\u0275fac=function(a){return new(a||l)},l.\u0275mod=e.$C({type:l}),l.\u0275inj=e.G2t({imports:[_.MD,h.YN,m.bv,B,U.x]}),i})()}}]);