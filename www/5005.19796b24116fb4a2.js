"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5005],{6013:(R,f,a)=>{a.d(f,{Gi:()=>u,vi:()=>r,Nn:()=>p});var d=a(5083),u=function(n){return n.Aztec="AZTEC",n.Codabar="CODABAR",n.Code39="CODE_39",n.Code93="CODE_93",n.Code128="CODE_128",n.DataMatrix="DATA_MATRIX",n.Ean8="EAN_8",n.Ean13="EAN_13",n.Itf="ITF",n.Pdf417="PDF_417",n.QrCode="QR_CODE",n.UpcA="UPC_A",n.UpcE="UPC_E",n}(u||{}),p=function(n){return n.Front="FRONT",n.Back="BACK",n}(p||{});const r=(0,d.F3)("BarcodeScanner",{web:()=>a.e(870).then(a.bind(a,870)).then(n=>new n.BarcodeScannerWeb)})},6043:(R,f,a)=>{a.d(f,{V:()=>p,j:()=>_});var d=a(467),u=a(5972);const _=function(){var h=(0,d.A)(function*(r){r.params=r.params||{},(0,u.hm)({url:`api/ChargingConnector/get-byqr/${r.params.QrCode}`,success:n=>{"function"==typeof r.callback&&r.callback(n.data||null)},error:n=>{var C;"function"==typeof r.callback&&r.callback(null==n||null===(C=n.response)||void 0===C?void 0:C.data),console.error(n)},loading:r.loading,loadingController:r.loadingController})});return function(n){return h.apply(this,arguments)}}(),p=function(){var h=(0,d.A)(function*(r){r.params=r.params||{},(0,u.hm)({url:`api/ChargingConnector/get-byid/${r.params.ChargeConnectorId}`,success:n=>{"function"==typeof r.callback&&r.callback(n.data||null)},error:n=>{var C;"function"==typeof r.callback&&r.callback(null==n||null===(C=n.response)||void 0===C?void 0:C.data),console.error(n)},loading:r.loading,loadingController:r.loadingController})});return function(n){return h.apply(this,arguments)}}()},5005:(R,f,a)=>{a.d(f,{I:()=>y});var d=a(467),u=a(9417),_=a(6013),p=a(6043),h=a(8650),r=a(8833),n=a(4438),C=a(7625),l=a(9465),P=a(3656),M=a(4842);const A=["QrCodeRef"],D=["square"];function T(c,v){if(1&c){const m=n.RV6();n.j41(0,"div",16)(1,"ion-button",17),n.bIt("click",function(){n.eBV(m);const o=n.XpG(2);return n.Njj(o.toggleTorch())}),n.nrm(2,"ion-icon",18),n.j41(3,"ion-label"),n.EFF(4),n.nI1(5,"translate"),n.k0s()()()}2&c&&(n.R7$(4),n.JRh(n.bMT(5,1,"TurnOnFlash")))}function N(c,v){if(1&c){const m=n.RV6();n.j41(0,"div")(1,"ion-range",19),n.bIt("ionChange",function(o){n.eBV(m);const t=n.XpG(2);return n.Njj(t.setZoomRatio(o))}),n.k0s()()}if(2&c){const m=n.XpG(2);n.R7$(),n.Y8G("min",m.minZoomRatio)("max",m.maxZoomRatio)}}function I(c,v){if(1&c&&(n.j41(0,"div",6),n.nrm(1,"div",14,1),n.j41(3,"div",15),n.DNE(4,T,6,3,"div",16)(5,N,2,2,"div"),n.k0s()()),2&c){const m=n.XpG();n.R7$(4),n.vxM(4,m.isTorchAvailable?4:-1),n.R7$(),n.vxM(5,void 0!==m.minZoomRatio&&void 0!==m.maxZoomRatio?5:-1)}}function k(c,v){1&c&&n.nrm(0,"div",20)}function U(c,v){1&c&&(n.j41(0,"div",7),n.nrm(1,"div",21),n.j41(2,"div",22),n.EFF(3),n.nI1(4,"translate"),n.k0s(),n.nrm(5,"div",21),n.k0s()),2&c&&(n.R7$(3),n.JRh(n.bMT(4,1,"Or")))}let y=(()=>{var c;class v{constructor(i,o,t,e,s,E,b){this.router=i,this.modalController=o,this.ngZone=t,this.platform=e,this.loadingController=s,this.toastController=E,this.animationController=b,this.formGroup=new u.J3({formats:new u.hs([]),lensFacing:new u.hs(_.Nn.Back),googleBarcodeScannerModuleInstallState:new u.hs(0),googleBarcodeScannerModuleInstallProgress:new u.hs(0)}),this.isCameraAvailable=!1,this.isTorchAvailable=!1}ngOnInit(){_.vi.isSupported().then(i=>{i.supported&&_.vi.checkPermissions().then(o=>{"granted"==o.camera&&(this.isCameraAvailable=!0,this.listenerScan(),this.startScan())})})}ngAfterViewInit(){}ngOnDestroy(){this.stopScan()}closeModal(i){var o=this;return(0,d.A)(function*(){o.modalController.dismiss({barcode:i})})()}navigateByUrl(i){var o=this;return(0,d.A)(function*(){o.modalController.dismiss().then(t=>{o.router.navigateByUrl(i)})})()}setZoomRatio(i){i.detail.value&&_.vi.setZoomRatio({zoomRatio:parseInt(i.detail.value,10)})}toggleTorch(){return(0,d.A)(function*(){yield _.vi.toggleTorch()})()}startScan(){var i=this;return(0,d.A)(function*(){_.vi.startScan().then(()=>{var o;null===(o=document.querySelector("body"))||void 0===o||o.classList.add("barcode-scanning-active"),_.vi.isTorchAvailable().then(t=>{i.isTorchAvailable=t.available}),_.vi.getMinZoomRatio().then(t=>{i.minZoomRatio=t.zoomRatio}),_.vi.getMaxZoomRatio().then(t=>{i.maxZoomRatio=t.zoomRatio})}).catch(()=>{i.stopScan()})})()}stopScan(){return(0,d.A)(function*(){var i;null===(i=document.querySelector("body"))||void 0===i||i.classList.remove("barcode-scanning-active"),yield _.vi.removeAllListeners(),yield _.vi.stopScan()})()}listenerScan(){var i=this;return(0,d.A)(function*(){var o;const t=null===(o=i.squareElement)||void 0===o?void 0:o.nativeElement.getBoundingClientRect(),e=t?{left:t.left*window.devicePixelRatio,right:t.right*window.devicePixelRatio,top:t.top*window.devicePixelRatio,bottom:t.bottom*window.devicePixelRatio,width:t.width*window.devicePixelRatio,height:t.height*window.devicePixelRatio}:void 0,s=e?[[e.left,e.top],[e.left+e.width,e.top],[e.left+e.width,e.top+e.height],[e.left,e.top+e.height]]:void 0,E=yield _.vi.addListener("barcodeScanned",function(){var b=(0,d.A)(function*(O){i.ngZone.run(()=>{const g=O.barcode.cornerPoints;s&&g&&(s[0][0]>g[0][0]||s[0][1]>g[0][1]||s[1][0]<g[1][0]||s[1][1]>g[1][1]||s[2][0]<g[2][0]||s[2][1]<g[2][1]||s[3][0]>g[3][0]||s[3][1]<g[3][1])||(E.remove(),i.changeBarcodeScanner(O.barcode))})});return function(O){return b.apply(this,arguments)}}())})()}changeBarcodeScanner(i){var o=this;return(0,d.A)(function*(){let t=i.rawValue.match(/charger-connect\/([0-9]{7})/);t&&(o.QrCode=t[1]||void 0),o.QrCode?o.submitQrCode():setTimeout(()=>{o.listenerScan()},1e3)})()}changeQrCode(i){var o=this;return(0,d.A)(function*(){o.QrCode=i.detail.value})()}keyupQrCode(i){var o=this;return(0,d.A)(function*(){var t,e;13!=i.keyCode?null===(t=o.QrCodeRef)||void 0===t||t.setValue(null===(e=i.target)||void 0===e?void 0:e.value):o.submitQrCode()})()}submitQrCode(i){var o=this;return(0,d.A)(function*(){o.QrCode&&(0,p.j)({loadingController:o.loadingController,params:{QrCode:o.QrCode},callback:t=>{var e;o.response=t,null!=t&&t.Succeeded?(o.chargingConnector=t.Data,o.navigateByUrl(r._.CHARGING_CONNECTOR_DETAIL.replace(":qrcode",null!==(e=o.QrCode)&&void 0!==e?e:""))):((0,h.Ip)(o.modalController,o.animationController,{message:{Title:"Error",Description:null==t?void 0:t.Message,Img:"assets/icon/ion-img/charging-error.svg"}}),setTimeout(()=>{o.listenerScan()},3e3))}})})()}}return(c=v).\u0275fac=function(i){return new(i||c)(n.rXU(C.Ix),n.rXU(l.W3),n.rXU(n.SKi),n.rXU(P.OD),n.rXU(l.Xi),n.rXU(l.K_),n.rXU(l.Hx))},c.\u0275cmp=n.VBU({type:c,selectors:[["app-modal-barcode-scanning"]],viewQuery:function(i,o){if(1&i&&(n.GBs(A,5),n.GBs(D,5)),2&i){let t;n.mGM(t=n.lsd())&&(o.QrCodeRef=t.first),n.mGM(t=n.lsd())&&(o.squareElement=t.first)}},decls:23,vars:9,consts:[["QrCodeInpRef",""],["square",""],["slot","start"],[3,"click"],["src","../../../assets/icon/ion-icon/arrow-left.svg"],["scroll-x","false","scroll-y","false"],[1,"container","h-100","p-0"],[1,"d-flex","align-items-center"],[1,"p-4","container-connect"],[1,"flex-grow-1","pr-2"],["lines","none"],["type","number","inputmode","decimal",3,"ionInput","keyup","placeholder"],[3,"click","color"],["src","../../../assets/icon/ion-icon/arrow-right.svg"],[1,"square"],[1,"zoom-ratio-wrapper"],[1,"text-center","mb-2"],["color","light","shape","round","fill","outline",3,"click"],["slot","start","name","flash"],["color","light",3,"ionChange","min","max"],[1,"w-100","h-100","container-bg"],[1,"col","border","border-top"],[1,"col-auto","px-3"]],template:function(i,o){if(1&i){const t=n.RV6();n.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",2)(3,"ion-button",3),n.bIt("click",function(){return n.eBV(t),n.Njj(o.closeModal())}),n.nrm(4,"ion-icon",4),n.k0s()(),n.j41(5,"ion-title"),n.EFF(6),n.nI1(7,"translate"),n.k0s()()(),n.j41(8,"ion-content",5),n.DNE(9,I,6,2,"div",6)(10,k,1,0),n.k0s(),n.j41(11,"ion-footer"),n.DNE(12,U,6,3,"div",7),n.j41(13,"div",8)(14,"div",7)(15,"div",9)(16,"ion-item",10)(17,"ion-input",11,0),n.nI1(19,"translate"),n.bIt("ionInput",function(s){return n.eBV(t),n.Njj(o.changeQrCode(s))})("keyup",function(s){return n.eBV(t),n.Njj(o.keyupQrCode(s))}),n.k0s()()(),n.j41(20,"div")(21,"ion-button",12),n.bIt("click",function(s){return n.eBV(t),n.Njj(o.submitQrCode(s))}),n.nrm(22,"ion-icon",13),n.k0s()()()()()}2&i&&(n.R7$(6),n.JRh(n.bMT(7,5,"ScanQR")),n.R7$(3),n.vxM(9,o.isCameraAvailable?9:10),n.R7$(3),n.vxM(12,o.isCameraAvailable?12:-1),n.R7$(5),n.FS9("placeholder",n.bMT(19,7,"EnterConnectorCode")),n.R7$(4),n.Y8G("color",o.QrCode?"primary":"medium"))},dependencies:[l.Jm,l.QW,l.W9,l.M0,l.eU,l.iq,l.$w,l.uz,l.he,l.Ob,l.BC,l.ai,l.su,M.D9],styles:['ion-content[_ngcontent-%COMP%]{--background: transparent;position:relative}.container-bg[_ngcontent-%COMP%]{background-color:var(--ion-background-color-primary)}.square[_ngcontent-%COMP%]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);border-radius:1rem;width:13rem;height:13rem;border:.25rem solid var(--ion-color-gray);box-shadow:0 0 0 1000px #00000040}.zoom-ratio-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:2;left:50%;bottom:2rem;transform:translate(-50%);width:100%;padding:0 3.5rem}.zoom-ratio-wrapper[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;min-height:2.5rem;min-width:2.5rem;--border-radius: 1.5rem;--padding-top: 0;--padding-start: 1rem;--padding-end: 1rem;--padding-bottom: 0;--background: rgba(var(--ion-color-light-rgb), .4)}.zoom-ratio-wrapper[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-weight:400}.container[_ngcontent-%COMP%]{position:relative}.container[_ngcontent-%COMP%]:before{content:"";display:block;position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;border:1rem solid var(--ion-background-color-primary);border-radius:0}.container[_ngcontent-%COMP%]:after{content:"";display:block;position:absolute;z-index:1;top:0;left:0;right:0;bottom:0;border:1rem solid var(--ion-background-color-primary);border-radius:2rem}.container-connect[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--min-height: 4rem;--border-radius: .5rem;--background: var(--ion-color-light)}.container-connect[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;min-height:4rem;min-width:4rem;--border-radius: .5rem;--padding-top: 0;--padding-start: 0;--padding-end: 0;--padding-bottom: 0}.container-connect[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}']}),v})()}}]);